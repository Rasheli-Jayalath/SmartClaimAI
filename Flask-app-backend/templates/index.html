<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <link rel="stylesheet" href="/static/style.css">
  <title>Damage Detection</title>
</head>

<body>
  <section class="test" id="test">
    <div class="heading2">
      <hr>
      <h1><b>Car Damage Detection</b></h1>
    </div>
    <div class="yolo">
      <form class="form-signin" method=post enctype=multipart/form-data>
        <h1 class="h3 mb-5 font-weight-normal">Upload any image</h1>
        <p><small>*Only jpg, jpeg. Less than 1MB size.</small></p>
        <input type="file" name="file" class="form-control-file" id="inputfile">
        <br />
        <button class="btn btn-lg btn-primary btn-block" type="button" onclick="postFile();">Upload</button>
        <br>
        <br>
        <br>
        <img style="display: none;" id="image" width="256" height="256" />
      </form>
    </div>
    <div>


    </div>
  </section>
  <script src="//code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"
    integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
    crossorigin="anonymous"></script>
  <script src="//stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"
    integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
    crossorigin="anonymous"></script>
  <script type="text/javascript">
    function postFile() {
      $('#inputfile').bind('change', function () {
        let fileSize = this.files[0].size / 1024 / 1024; // this gives in MB
        if (fileSize > 1) {
          $("#inputfile").val(null);
          alert('file is too big. images more than 1MB are not allowed');
          return
        }
        let ext = $('#inputfile').val().split('.').pop().toLowerCase();
        if ($.inArray(ext, ['jpg', 'jpeg']) == -1) {
          $("#inputfile").val(null);
          alert('only jpeg/jpg files are allowed!');
          return;
        }
      });

      var file = $("#inputfile")[0].files[0];

      var formData = new FormData();
      formData.append("file", file);

      var xhr = new XMLHttpRequest();
      xhr.responseType = 'blob';

      xhr.onload = displayResult;
      xhr.open('POST', '/', true);
      xhr.send(formData);
    }
    function displayResult(e) {
      var urlCreator = window.URL || window.webkitURL;
      var imageUrl = urlCreator.createObjectURL(this.response);
      document.querySelector("#image").src = imageUrl;
      document.querySelector("#image").style.display = 'block';
    }
  </script>
</body>

</html>